webpackJsonp([2],Array(54).concat([function(e,t,n){"use strict";var o=n(27),i=n(158),s=n(143),r=n.n(s);o.a.use(i.a),t.a=new i.a({routes:[{path:"/",name:"Editor",component:r.a}]})},,function(e,t,n){function o(e){n(102)}var i=n(3)(n(59),n(150),o,null,null);e.exports=i.exports},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(27),i=n(56),s=n.n(i),r=n(54),a=n(57),c=n(55),l=n.n(c);o.a.prototype.$http=l.a,o.a.use(a.a),o.a.config.productionTip=!1,new o.a({el:"#app",router:r.a,template:"<App/>",components:{App:s.a}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"app"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(142),i=n.n(o),s=n(144),r=n.n(s),a=n(146),c=n.n(a);t.default={name:"Annotator",components:{AreaSelect:i.a,PDF:r.a,SelectionPreview:c.a},created:function(){console.log("Annotator created")},props:["src","name","selections","addSelection","arrayBuffer","setPdfSize"],data:function(){return{text:"",down:!1,coords:{xa:null,ya:null,xb:null,yb:null},pageNumber:1,pageOffset:{top:0,left:0}}},computed:{coordinates:function(){return{left:Math.min(this.coords.xa,this.coords.xb),top:Math.min(this.coords.ya,this.coords.yb),width:Math.abs(this.coords.xa-this.coords.xb),height:Math.abs(this.coords.ya-this.coords.yb),page:this.pageNumber,pageOffset:{top:this.pageOffset.top,left:this.pageOffset.left}}}},methods:{reset:function(){this.coords.xa=null,this.coords.ya=null,this.coords.xb=null,this.coords.yb=null},start:function(e){this.down=!0,this.pageNumber=parseInt(e.target.getAttribute("data-page-number")||1),this.pageOffset.top=e.target.offsetTop,this.pageOffset.left=e.target.offsetLeft,this.coords.xa=e.offsetX,this.coords.ya=e.offsetY,this.coords.xb=e.offsetX,this.coords.yb=e.offsetY},end:function(e){e.stopPropagation(),e.preventDefault(),this.down=!1,this.addSelection(this.coordinates),this.reset()},drag:function(e){if(e.stopPropagation(),e.preventDefault(),this.down){this.coords.xb=e.offsetX,this.coords.yb=e.offsetY;var t=window.getSelection();this.text=t.toString()}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"area-select",props:["coordinates","color","name","active"],created:function(){console.log("AreaSelect created"),console.log({offset:this.coordinates.pageOffset})},computed:{styleObject:function(){return 0===this.height||0===this.width?{display:"none"}:{left:this.coordinates.left+this.coordinates.pageOffset.left+"px",top:this.coordinates.top+this.coordinates.pageOffset.top+"px",width:this.coordinates.width+"px",height:this.coordinates.height+"px",border:"solid "+this.color+" 1px",background:this.color.replace(/\)$/,", 0.05)").replace("rgb(","rgba(")}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(147),i=n.n(o),s=n(141),r=n.n(s),a=n(148),c=n.n(a),l=n(145),d=n.n(l),f=n(126),u=n.n(f);t.default={name:"editor",components:{Uploader:i.a,Annotator:r.a,ZoneViewer:c.a,PDFZoneViewer:d.a},data:function(){return{doc:null,c:0,pid:null,style:[],old_obs:[],req1_stat:!1,change:!1,file:null,obs:[],src:null,arrayBuffer:null,name:"",selections:[],pdfDimensions:{height:0,width:0}}},created:function(){console.log("Editor created")},methods:{addfile:function(e){this.file=e},post:function(){if(this.change){var e=new FormData;e.append("pfile",this.file),this.req1_stat=!0,this.$http.post("http://127.0.0.1:5000/post_pdf",{data:e},function(e,t,n){this.postResults=e,this.ajaxRequest=!1}).then(function(e){console.log(e),console.log([{pdf:this.file,name:this.name}]),console.log("wait finished"),this.pid=e.pid,this.change=!1,this.req1_stat=!1,this.poost()}).catch(function(e){console.log("From catch")})}},poost:function(){this.post()},updateobj:function(e){this.obs=e},batchUpdateSelections:function(e){this.selections=e},setPdfSize:function(e,t){this.pdfDimensions={width:e,height:t}},addSelection:function(e){0!==e.height&&0!==e.width&&(console.log(e.pageOffset),this.selections.push({id:+new Date,coordinates:{top:e.top,left:e.left,height:e.height,width:e.width,page:e.page,pageOffset:e.pageOffset},color:u()({format:"rgb"}),name:"Box"+this.selections.length}),this.c++,this.style.push({id:this.c,s:{top:e.top+e.pageOffset.top+"px",left:e.left+e.pageOffset.left+"px",height:e.height+"px",width:e.width+"px"}}),console.log(e.pageOffset))},newFile:function(e){this.name===e.name?this.change=!1:this.change=!0,console.log(e),this.doc=e,this.name=e.name,this.src=e.src,this.arrayBuffer=e.arrayBuffer,this.selections=[],this.obs=[],this.style=[],this.c=0}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(121),i=n.n(o),s=n(122);s.PDFViewer=i.a.PDFJS.PDFViewer,t.default={props:["arrayBuffer","setPdfSize"],data:function(){return{width:null}},created:function(){console.log("PDF created")},computed:{styleObject:function(){return{width:this.width?this.width+"px":"auto"}}},watch:{arrayBuffer:function(){this.loadDocument()}},methods:{loadDocument:function(){var e=this;console.log("new document"),s.getDocument(this.arrayBuffer).then(function(t){t.getPage(1).then(function(n){var o=n.getViewport(1);e.setPdfSize(o.width,o.height),e.width=o.width,e.pdfViewer.setDocument(t).then(function(){window.scrollTo(0,0)})})})}},mounted:function(){var e=this,t=this.$refs["pdf-container"];this.pdfViewer=new s.PDFViewer({container:t}),t.addEventListener("pagesinit",function(){e.pdfViewer.currentScaleValue="page-width"}),this.loadDocument()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:["selections","batchUpdateSelections","originalFilename","dimensions"],data:function(){return{c:0,pr:null,obs:[],uzn:null,editing:!1}},computed:{downloadable:function(){var e=new Blob([this.uzn],{type:"octet/stream"});return window.URL.createObjectURL(e)},filename:function(){return this.originalFilename.replace(/(.*)\..*/,"$1.uzn")}},mounted:function(){this.redrawUzn()},watch:{selections:function(){this.redrawUzn()}},created:function(){console.log("PDFZONe  created")},methods:{startEditing:function(){this.editing=!0},stopEditing:function(){this.editing=!1,this.redrawUzn()},redrawUzn:function(){var e=this;if(!this.editing){if(0===this.selections.length)return this.uzn="",this.obs=[],void(this.c=0);var t=this.selections.map(function(t){var n=parseInt(e.dimensions.height-t.coordinates.top),o=parseInt(e.dimensions.height-t.coordinates.top-t.coordinates.height),i=t.coordinates.left;e.c!==e.selections.length&&(e.c++,e.obs.push({id:null,pageno:t.coordinates.page,cordinates:{zname:t.name,lx:t.coordinates.left,ly:Math.max(n,o),rx:t.coordinates.left+t.coordinates.width,ry:Math.min(n,o)}})),e.pr=i;var s=[t.coordinates.left,Math.max(n,o),t.coordinates.left+t.coordinates.width,Math.min(n,o)].join(","),r="LTPage[pageid=\\'"+t.coordinates.page+"\\'] LTTextLineHorizontal:overlaps_bbox(\""+s+'")';return"\t('"+t.name+"', '"+r+"')"});this.$emit("updateob",this.obs);var n=t.join(",\n");this.uzn="pdf = pdfquery.PDFQuery('"+this.originalFilename+"')\n\npdf.extract([\n\t('with_formatter', 'text'),\n"+n+"\n])",console.log(this.obs)}},changed:function(e){var t=this;console.log("CHANGED");var n=0,o=this.uzn.split("\n").map(function(e){var o=e.match(/\('(.*)',.*pageid=\\'(\d+)\\'.*bbox\("(\d+),(\d+),(\d+),(\d+)"\)/);try{var i=t.selections[n];return i.coordinates.left=parseInt(o[3]),i.coordinates.top=t.dimensions.height-parseInt(o[4]),i.coordinates.width=parseInt(o[5])-parseInt(o[3]),i.coordinates.height=Math.abs(parseInt(o[6])-parseInt(o[4])),i.name=o[1],i.page=o[2],n++,i}catch(e){return console.log(e),null}}).filter(function(e){return null!=e});this.batchUpdateSelections(o)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(68),i=n.n(o);t.default={props:["coordinates"],data:function(){return{text:null}},computed:{},watch:{coordinates:function(){this.highlightOverlaps()}},methods:{hasCoordinates:function(){var e=this.coordinates;return!!(e&&e.top&&e.left&&0!==e.height&&0!==e.width)},overlapping:function(){if(this.hasCoordinates()){var e=document.querySelectorAll('.page[data-page-number="1"] .textLayer div');return Array.prototype.filter.call(e,this._overlaps)}return[]},overlappingText:function(){return this.overlapping().map(function(e){return e.textContent}).join(" ")},highlightOverlaps:function(){this.unhighlight(),this.overlapping().forEach(this._highlight)},_highlight:function(e){-1===e.className.indexOf("selected-preview")&&(e.className+=" selected-preview")},unhighlight:function(e){var t=document.querySelectorAll(".selected-preview"),n=!0,o=!1,s=void 0;try{for(var r,a=i()(t);!(n=(r=a.next()).done);n=!0){var c=r.value;c.className=c.className.replace("selected-preview","")}}catch(e){o=!0,s=e}finally{try{!n&&a.return&&a.return()}finally{if(o)throw s}}},_overlaps:function(e){var t=this.coordinates;return!(e.offsetLeft>t.left+t.width||e.offsetLeft+e.offsetWidth<t.left)&&!(e.offsetTop>t.top+t.height||t.top>e.offsetTop+e.offsetHeight)},_sorted:function(e,t){return e.offsetTop===t.offsetTop?e.offsetLeft<t.offsetTop?-1:1:e.offsetTop<t.offsetTop?-1:1}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{notify:{type:Function,require:!0}},data:function(){return{name:null,pdf_file:null}},created:function(){console.log("Uploader created")},methods:{processReaderImage:function(e){this.notify({name:this.name,src:e.target.result})},processReaderPDF:function(e){this.notify({name:this.name,arrayBuffer:e.target.result})},getFile:function(e){var t=e[0];if(this.name=t.name,t.type.match("image.*")){var n=new FileReader;n.addEventListener("load",this.processReaderImage,!1),n.readAsDataURL(t),this.pdf_file=t}else if(t.type.match(".*pdf.*")){var o=new FileReader;o.addEventListener("load",this.processReaderPDF,!1),o.readAsArrayBuffer(t),this.pdf_file=t}else alert("Not a PDF or image file");this.$emit("addfile",this.pdf)},selected:function(e){this.getFile(e.target.files)},drop:function(e){e.stopPropagation(),e.preventDefault(),this.getFile(e.dataTransfer.files)},dragover:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"zone-viewer",props:["selections","batchUpdateSelections","originalFilename"],data:function(){return{uzn:null,editing:!1}},created:function(){console.log("ZoneViewer created")},computed:{downloadable:function(){var e=new Blob([this.uzn],{type:"octet/stream"});return window.URL.createObjectURL(e)},filename:function(){return this.originalFilename.replace(/(.*)\..*/,"$1.uzn")}},mounted:function(){this.redrawUzn()},watch:{selections:function(){this.redrawUzn()}},methods:{startEditing:function(){this.editing=!0},stopEditing:function(){this.editing=!1,this.redrawUzn()},redrawUzn:function(){if(!this.editing){var e=this.selections.map(function(e){return e.coordinates.left+" "+e.coordinates.top+" "+e.coordinates.width+" "+e.coordinates.height+" "+e.name});this.uzn=e.join("\n")}},changed:function(e){var t=this,n=this.uzn.split("\n").map(function(e,n){try{var o=e.match(/(\d+) (\d+) (\d+) (\d+) (.*)/),i=t.selections[n];return i.coordinates.left=parseInt(o[1]),i.coordinates.top=parseInt(o[2]),i.coordinates.width=parseInt(o[3]),i.coordinates.height=parseInt(o[4]),i.name=o[5],i}catch(e){return null}}).filter(function(e){return null!=e});console.log("updating with",n),this.batchUpdateSelections(n)}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){function o(e){n(105)}var i=n(3)(n(60),n(153),o,"data-v-5470518d",null);e.exports=i.exports},function(e,t,n){function o(e){n(101)}var i=n(3)(n(61),n(149),o,"data-v-10ce4bf0",null);e.exports=i.exports},function(e,t,n){function o(e){n(104)}var i=n(3)(n(62),n(152),o,null,null);e.exports=i.exports},function(e,t,n){function o(e){n(108)}var i=n(3)(n(63),n(156),o,null,null);e.exports=i.exports},function(e,t,n){function o(e){n(109)}var i=n(3)(n(64),n(157),o,"data-v-c71d66be",null);e.exports=i.exports},function(e,t,n){function o(e){n(107)}var i=n(3)(n(65),n(155),o,null,null);e.exports=i.exports},function(e,t,n){function o(e){n(106)}var i=n(3)(n(66),n(154),o,"data-v-7bb46fcd",null);e.exports=i.exports},function(e,t,n){function o(e){n(103)}var i=n(3)(n(67),n(151),o,null,null);e.exports=i.exports},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"selection-box",style:e.styleObject},[n("span",[e._v(e._s(e.name))])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.selections.length>0?n("div",{staticClass:"zone-viewer"},[n("h2",[e._v("Your zone file")]),e._v(" "),e._m(0),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.uzn,expression:"uzn"}],ref:"textarea",domProps:{value:e.uzn},on:{keyup:e.changed,blur:e.stopEditing,focus:e.startEditing,input:function(t){t.target.composing||(e.uzn=t.target.value)}}}),e._v(" "),n("a",{attrs:{href:e.downloadable,download:e.filename}},[e._v("Download .uzn file")])]):e._e()},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("strong",[e._v("Edit the code below")]),e._v(" and it'll update on the right!")])}]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"editor"},[n("div",{staticClass:"sidebar"},[n("h1",[e._v("PDF - Annotator")]),e._v(" "),n("Uploader",{attrs:{notify:e.newFile},on:{addfile:e.addfile}}),e._v(" "),e.src?n("ZoneViewer",{staticClass:"zone-viewer",attrs:{selections:e.selections,batchUpdateSelections:e.batchUpdateSelections,originalFilename:e.name}}):e._e(),e._v(" "),e.arrayBuffer?n("PDFZoneViewer",{staticClass:"zone-viewer",attrs:{dimensions:e.pdfDimensions,selections:e.selections,batchUpdateSelections:e.batchUpdateSelections,originalFilename:e.name},on:{updateob:e.updateobj}}):e._e(),e._v(" "),n("button",{on:{click:e.poost}},[n("center",[e._v("submit")])],1)],1),e._v(" "),n("div",{staticClass:"content"},[n("Annotator",{attrs:{src:e.src,setPdfSize:e.setPdfSize,arrayBuffer:e.arrayBuffer,name:e.name,selections:e.selections,addSelection:e.addSelection}}),e._v(" "),e._l(e.style,function(t){return n("div",{key:t.c},[n("select",{style:t.s,attrs:{name:"2",id:"2"}},[n("option",{attrs:{value:"af"}},[e._v("sdsdg")]),e._v(" "),n("option",{attrs:{value:"a"}},[e._v("fadfa")])])])})],2)])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.name?n("h3",[e._v("\n    Currently working on: "),n("span",{staticClass:"filename"},[e._v(e._s(e.name))]),e._v(" "),n("span",{staticClass:"filetype"},[e._v(e._s(e.arrayBuffer?"PDF":"image"))])]):e._e(),e._v(" "),e.src||e.arrayBuffer?n("div",{ref:"selectionArea",staticClass:"selection-area",on:{mousedown:e.start,mouseup:e.end,mousemove:e.drag}},[e.src?n("img",{attrs:{src:e.src}}):e._e(),e._v(" "),e.arrayBuffer?n("PDF",{attrs:{setPdfSize:e.setPdfSize,arrayBuffer:e.arrayBuffer}}):e._e(),e._v(" "),n("div",{staticClass:"area-select"},[e.arrayBuffer?n("SelectionPreview",{attrs:{coordinates:e.coordinates}}):e._e(),e._v(" "),n("AreaSelect",{ref:"activeSelector",attrs:{coordinates:e.coordinates,color:"rgb(0,255,0)",active:"true"}}),e._v(" "),e._l(e.selections,function(e){return n("AreaSelect",{key:e.id,attrs:{color:e.color,coordinates:e.coordinates,name:e.name}})})],2)],1):e._e()])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{attrs:{id:"dragover"},on:{dragover:e.dragover,drop:e.drop}},[n("h3",[e._v("Drag & drop your file here")]),e._v(" "),e._m(0),e._v(" "),n("input",{attrs:{type:"file",id:"file",name:"file"},on:{change:e.selected}})])])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("or "),n("label",{attrs:{for:"file"}},[e._v("click to browse")])])}]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"preview"},[e._v("\n"+e._s(e.text)+"\n")])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"pdf-container",staticClass:"pdf-container",style:e.styleObject},[n("div",{staticClass:"pdfViewer"})])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.selections.length>0?n("div",{staticClass:"pdf-zone-viewer"}):e._e()},staticRenderFns:[]}},,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){}]),[58]);
//# sourceMappingURL=app.bc3afc406d34ca858d80.js.map